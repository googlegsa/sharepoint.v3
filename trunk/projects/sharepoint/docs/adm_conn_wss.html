<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "DTD/xhtml1-transitional.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link rel="stylesheet" type="text/css" href="http://code.google.com/css/dev_docs.css" />
<link rel="stylesheet" type="text/css" href="local_extensions.css" />

<!--[if IE 7]>
  <link rel="stylesheet" type="text/css" href="http://code.google.com/css/ie7only.css" />
<![endif]-->
<!--[if lte IE 6]>
  <link rel="stylesheet" type="text/css" href="http://code.google.com/css/ie6only.css" />
<![endif]-->
<!--[if IE]>
  <link rel="stylesheet" type="text/css" href="http://code.google.com/css/ieonly.css" />
<![endif]-->

<!-- Add ECM product name to title -->
<title>Google Enterprise Connector for Microsoft SharePoint Server 2007 </title>
<style>
<!--
.style1 {
	FONT-FAMILY: Arial, Helvetica, sans-serif
}
.style2 {
	FONT-FAMILY: "Courier New", Courier, monospace
}
-->
</style>
</head>


<body id="intro_page">
<A name=top></A><!-- ########## PAGE HEADER ########## -->
<DIV id=header>
<DIV id=logo><A href="http://code.google.com/">
	<IMG
alt="Return to Google Code homepage"
src="code_sm.png"
border=0></A></DIV>
<H1 id=doc_title>Google Search Appliance</H1></DIV><!-- ########## END PAGE HEADER ########## -->
<DIV id=wrapper><!-- ########## SIDE NAVIGATION ########## -->
<DIV id=sidenav>
<UL>
  <LI>
  <H1>Search Appliance </H1>
  <UL><!-- ID tag identifies current page -->
    <LI><A id=overview_link
    href="http://code.google.com/apis/searchappliance/index.html">Overview</A>
    <LI><A id=docs_link
    href="http://code.google.com/apis/searchappliance/documentation/50/index.html">Documentation
    Home</A> </LI></UL>
  <LI>
  <DIV class=line></DIV>
  <LI>
  <H1>Configuring the Google Enterprise Connector for Microsoft SharePoint
	Server 2003 and Microsoft SharePoint Server 2007</H1>
  <LI>
  <DIV class=line></DIV>
  <LI>
  <H1>Support Resources </H1>
  <UL>
    <LI><A href="https://support.google.com/enterprise/faqs">Frequently Asked
    Questions</A>
    <LI><A href="http://groups.google.com/group/Google-Search-Appliance">Google
    Search Appliance Discussion Group</A>
    <LI><A href="http://groups.google.com/group/Google-Mini">Google Mini
    Discussion Group</A>
    <LI><A href="https://support.google.com/enterprise/contactsupport">Contact
    Support</A> </LI></UL></LI></UL>
<DIV class=search>
<FORM action=http://www.google.com/search method=get>
<DIV><INPUT type=hidden value=code.google.com name=domains> <INPUT type=hidden
value=code.google.com name=sitesearch>
<DIV class=header>Search Google Code</DIV>
<DIV class=input><INPUT size=10 name=q> </DIV>
<DIV class=button><INPUT type=submit value=Search>
</DIV></DIV></FORM></DIV></DIV><!-- ########## END SIDE NAVIGATION ########## --><!-- ########## PAGE CONTENT ########## -->
<DIV id=pagecontent>
<H1 id=page_title>Configuring the Google Enterprise Connector for Microsoft
SharePoint Server 2003 and Microsoft SharePoint Server 2007</H1>
<P>Google Search Appliance software version 5.0<BR>
<span style="background-color: #FFFFFF">Posted October, 2007<BR>1st Revision November, 2007</span></P>
<span style="background-color: #FFFFFF">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2nd
Revision December, 2007</span><BR>
<P>This document is for Google Search Appliance administrators who want to set
up and manage connector for Microsoft SharePoint Server 2003 and Microsoft
SharePoint Server 2007. Read this <SPAN
style="BACKGROUND-COLOR: #ffffff">document</SPAN> and the following related
documents:</P>
<UL>
  <LI><B><A
  href="http://code.google.com/apis/searchappliance/documentation/50/connector_admin/admin_connector.html">Administering
  Connectors</A></B>
  <P>This document gives an overview of how connectors work and describes the
  configuration steps common to all the connectors. </P></LI></UL>
<UL>
  <LI><B>Google Search Appliance Help Topics</B>
  <P>These pages describe connector independent configuration parameters
  available in the Connector Administration pages of the admin
console.</P></LI></UL>
<H1>Contents</H1>
<OL class=toc>
  <LI><A
  href="http://code.google.com/apis/searchappliance/documentation/50/connector_admin/sharepoint_connector.html#introanch">Introduction</A>

  <LI><A
  href="http://code.google.com/apis/searchappliance/documentation/50/connector_admin/sharepoint_connector.html#versanch">Supported
  Repository Product Version</A>
  <LI><A
  href="http://code.google.com/apis/searchappliance/documentation/50/connector_admin/sharepoint_connector.html#SupportedOS">Supported
  Operating Systems</A>
  <LI><A
  href="http://code.google.com/apis/searchappliance/documentation/50/connector_admin/sharepoint_connector.html#schsuppanch">How
  Search is Supported</A>
  <LI><A
  href="http://code.google.com/apis/searchappliance/documentation/50/connector_admin/sharepoint_connector.html#secsuppanch">How
  Security is Supported</A>
  <LI><A
  href="http://code.google.com/apis/searchappliance/documentation/50/connector_admin/sharepoint_connector.html#instanch">Installing
	the Google Enterprise Connector for Microsoft SharePoint Server</A>

  <OL class=toc>
	<LI><A
    href="http://code.google.com/apis/searchappliance/documentation/50/connector_admin/sharepoint_connector.html#InstallAuto">Installing
    the Connector Using the Installer</A>
    <LI><A
    href="http://code.google.com/apis/searchappliance/documentation/50/connector_admin/sharepoint_connector.html#installConnector">Installing
    the Connector Manually</A>
    </OL>
  <LI><A
  href="http://code.google.com/apis/searchappliance/documentation/50/connector_admin/sharepoint_connector.html#confanch">Configuring
  the Connector </A>
	<p>&nbsp;&nbsp;&nbsp; <A
    href="http://code.google.com/apis/searchappliance/documentation/50/connector_admin/sharepoint_connector.html#InstallAuto">
	Registering Connector Manager on Google Search Appliance</A><OL class=toc>
    <LI><A
    href="http://code.google.com/apis/searchappliance/documentation/50/connector_admin/sharepoint_connector.html#confconanch">Configuring
    Connector Instances</A>
    <LI><A
    href="http://code.google.com/apis/searchappliance/documentation/50/connector_admin/sharepoint_connector.html#ScheduleConnector">Scheduling
    the Connector</A>
    <LI><A
    href="http://code.google.com/apis/searchappliance/documentation/50/connector_admin/sharepoint_connector.html#confecmanch">Configuring
    Microsoft SharePoint Server for the Connector</A> </LI></OL>
  <LI><A
  href="http://code.google.com/apis/searchappliance/documentation/50/connector_admin/sharepoint_connector.html#troubanch">Troubleshooting</A>

  <OL class=toc>
    <LI><a href="#issueanch">Known Limitations</a>
    <LI><A
    href="http://code.google.com/apis/searchappliance/documentation/50/connector_admin/sharepoint_connector.html#erranch">Error
    Messages</A> </LI></OL>
  <LI><A
  href="http://code.google.com/apis/searchappliance/documentation/50/connector_admin/sharepoint_connector.html#relatedanch">Related
  Documentation</A> </LI></OL>
<H1><A id=introanch name=introanch></A>Introduction</H1>
<P><CODE><FONT face=Arial>The Google Enterprise Connector for Microsoft
SharePoint Server 2003 and Microsoft SharePoint Server 2007 </FONT></CODE><FONT face=Arial>enables the </FONT>Google
Search Appliance to traverse documents and attachments on SharePoint sites.
Instances of the connector fetch metadata and <ACRONYM
title="uniform resource locator">URLs</ACRONYM> for SharePoint documents and
attachments using SharePoint Web services and direct the data to the Google
Search Appliance as a metadata and URL feed.</P>
<H1><A id=verssanch name=versanch></A>Supported Repository Product Versions</H1>
<P>This connector is supported with Microsoft Office SharePoint Server 2007
(MOSS 2007), Microsoft&nbsp;SharePoint Portal Server 2003 (SPS 2003), Microsoft Windows SharePoint Services 3.0 (WSS 3.0)
and Microsoft Windows SharePoint Services 2.0 (WSS 2.0).</P>
<H1><A id=SupportedOS name=SupportedOS></A>Supported Operating Systems</H1>
<P>The Google Enterprise Connector for Microsoft SharePoint Server 2003 and
Microsoft SharePoint Server 2007 is
supported on the following operating systems:</P>
<UL>
  <LI>Windows XP SP2
  <LI>Windows 2003 Server Enterprise Edition
  <LI>Red Hat Enterprise Linux 4 </LI></UL>
<H1><A id=schsuppanch name=schsuppanch></A>How Search is Supported </H1>
<P>The Microsoft SharePoint connector can traverse the following types of
content:</P>
<p>&nbsp;<b>SPS 2003 and WSS 2.0</b></p>
<ul>
	<li>Public and Personal Sites </li>
	<li>Folder </li>
	<li>File </li>
	<li>Document Library </li>
	<li>Discussion Boards </li>
	<li>Site </li>
	<li>Web </li>
	<li>Attachment </li>
	<li>Links </li>
	<li>Tasks </li>
	<li>Contacts </li>
	<li>Announcements </li>
	<li>Issues </li>
	<li>Events </li>
	<li><span style="font-family: Arial">Surveys </span></li>
	<li><span style="font-family: Arial">Custom Lists</span></li>
	<li><span style="font-family: Arial">Picture Library </span></li>
	<li><span style="font-family: Arial">Unknown Document Type </span></li>
	<li><span style="font-family: Arial">Form Library </span></li>
	<li><span style="font-family: Arial">Alerts </span></li>
</ul>
<p>&nbsp;<b>MOSS 2007 and WSS 3.0</b></p>
<ul>
	<li>Public and Personal Sites </li>
	<li>Folder </li>
	<li>File </li>
	<li>Document Library </li>
	<li>Discussion Boards </li>
	<li>Site </li>
	<li>Web </li>
	<li>Attachment </li>
	<li>Links </li>
	<li>Wikipage Library </li>
	<li>Tasks </li>
	<li>Calendar&nbsp; </li>
	<li>Contacts </li>
	<li>Announcements </li>
	<li>Issues </li>
	<li><span style="font-family: Arial">Surveys </span></li>
	<li><span style="font-family: Arial">Custom Lists</span></li>
	<li><span style="font-family: Arial">Picture Library </span></li>
	<li><span style="font-family: Arial">Unknown Document Type </span></li>
	<li><span style="font-family: Arial">Project Tasks&nbsp; </span></li>
	<li><span style="font-family: Arial">Administrative Tasks </span></li>
	<li><span style="font-family: Arial">Report Library </span></li>
	<li><span style="font-family: Arial">Translation Management Library </span>
	</li>
	<li><span style="font-family: Arial">Data Connection Library </span></li>
	<li><span style="font-family: Arial">Slide Library </span></li>
	<li><span style="font-family: Arial">Form Library </span></li>
	<li><span style="font-family: Arial">Alerts </span></li>
</ul>
<H1><A id=secsuppanch name=secsuppanch></A>How Security is Supported</H1>
<P>During crawl and index, the Microsoft SharePoint connector and the Google
Search Appliance require user credentials:</P>
<UL>
  <LI>The connector instance uses its credentials to obtain metadata and a list
  of URLs (e.g. <a href="http://www.mysite.com:8081/DocumentLibrary/file.doc">
	http://www.mysite.com:8081/DocumentLibrary/file.doc</a> ) from SharePoint. This user account must have access to web services on
  the SharePoint site. For more information on user permissions, see <A
  href="http://code.google.com/apis/searchappliance/documentation/50/connector_admin/sharepoint_connector.html#confecmanch">Configuring
  Microsoft SharePoint Server for the Connector</A>.
  </UL>
<UL>
  <LI>The Google Search Appliance uses credentials on the Admin Console's
  Crawler Access page to request content for each of the URLs in the feed
  provided by the connector instance. This user account must have &#8220;Read&#8221; access
  for all content on the SharePoint site that you want to include searches. You
  must provide a domain name or host name in order to enable Windows NT LAN
  Manager (NTLM) or <ACRONYM title="hypertext transfer protocol">HTTP</ACRONYM>
  authentication.&nbsp; </LI></UL>
<P>During serve, the content from a SharePoint site can be served as public or
secure content, based on the <B>Make Public</B> checkbox on the <B>Crawler
Access</B> page.</P>
<UL>
  <LI>When you select the <B>Make Public </B>checkbox, content from the
  specified URL is made available as public content. It is then possible for
  anyone to search this content.
  <LI>When you clear the <B>Make Public </B>checkbox, content from the specified
  URL is made available as secure content. A user must enter a username and
  password, and have authorization in order to view the content in the search
  results. The Google Search Appliance uses NTLM or HTTP to verify the user's
  credentials. </LI></UL>
<H1><A id=instanch name=instanch></A>Installing the Google Enterprise Connector
for Microsoft SharePoint Server</H1>
<P>This section describes the installation prerequisites and installation
process for the Google Enterprise Connector for Microsoft SharePoint Server 2003
and Microsoft SharePoint Server 2007.&nbsp;</P>
<P>You can install the connector using an installer that installs Apache Tomcat,
a connector manager, and the connector or you can install the three software
components manually. Google recommends that you use the installer unless you are
building the connector manager or connector from the source code or you are
installing a patch release that is not packaged with an installer.&nbsp; </P>
<H2><A id=InstallAuto name=InstallAuto></A>Installing the Connector Using the
Installer </H2>
<P><b>Pre-Installation steps:</b></P>
<P class=note><B>Note :</B> Before installing the connector using the Installer,
ensure that the following tasks have been performed</P>
<OL>
  <LI>Install <a href="http://java.sun.com/j2se/1.4.2/download.html">Java Development Kit (JDK) 1.4.2 (or later)</a> on the host
	where the connector is to be installed.
  </OL>
<P><b>To download and unzip the installation package: </b> </P>
<OL>
  <LI>Log in to the host using an account with sufficient privileges to install
  the software.
  <LI>Start a web browser.
  <LI>Navigate to the <A href="https://support.google.com/enterprise/">Google
  Enterprise Technical Support</A> web site and log in.
  <LI>In the left-hand navigation bar, click <strong>Connectors</strong>.<LI>Download the software distribution package to the host where you are
  installing the software.
  <LI>Unzip the package.
  <LI>If you are on Windows, skip step 8 and proceed to instructions steps for installing Tomcat, a connector manager,
	and the connector.
  <LI>If you are on Linux, follow these instructions.
  <OL>
    <LI>Open a terminal window and go to the base directory of the GCI.bin file
    in the extracted folder.
    <LI>Give the GCI.bin file execute permission.
    <LI>To run the installer in graphical mode, execute the following command:
    <P><SPAN class=style2>./GCI.bin
    LAX_VM/<EM>java_location_to_java</EM></SPAN></P>for example,<SPAN
    class=style2> ./GCI.bin LAX_VM /usr/java/j2sdk1.4.2_15/bin/java</SPAN>
    <LI>To run the installer in console mode, execute the command with the<SPAN
    class=style2> -i console</SPAN> argument appended.
    <LI>Go to the instructions below and proceed from Step 2.
<BR></LI></OL></LI></OL>
<P><b>Installation Steps:</b></P>
<P class=note><B>Note :</B> To install Apache Tomcat, a Connector Manager, and
the Google Enterprise Connector for SharePoint using the Installer</P>
<OL>
  <LI>Double-click the installer executable to start the installer.
  <LI>Click <STRONG>Next</STRONG>.
  <P>The License Agreement panel appears.</P>
	<LI>Indicate whether you accept or decline the terms of the license and click
  	<STRONG>Next</STRONG>:
  	<UL>
		<LI>To accept the license, click <STRONG>I accept the terms of the License
    Agreement. </STRONG>
		<LI>To decline the terms, click <STRONG>I do NOT accept the terms of the
    License Agreement</STRONG>. </LI>
	</UL>
	<LI>On the <STRONG>Select Connector</STRONG> panel, select <STRONG>Microsoft
  SharePoint </STRONG>and click <STRONG>Next</STRONG>.
  <LI>If the <STRONG>Connector Selection</STRONG> panel is displayed, choose
  <STRONG>Install new Google Connector</STRONG> and click <STRONG>Next</STRONG>.

  <LI>On the <STRONG>Connector Configuration</STRONG> panel, enter the name you
  want to assign the connector and a port number that is not already used by
  another application.
  The checkbox &quot;<b>Start SharePoint Connector Service after installation</b>&quot;
	determines whether the connector service should start automatically on
	completion of the installation or started manually. It is checked by
	default.<LI>Click <STRONG>Next</STRONG>.
  <LI>On the <STRONG>Choose Java Development Kit</STRONG> panel, choose the
  correct JDK for the connector to use and or click <STRONG>Search for
  Others</STRONG> if the correct JDK is not in the list.
  The connector requires JDK 1.4.2 or later.<LI>Click <STRONG>Next</STRONG>.
  <LI>On the <STRONG>Choose Install Folder </STRONG>panel, click
  <STRONG>Next</STRONG> to accept the default location or click
  <STRONG>Choose</STRONG> to navigate to a different folder, then click
  <STRONG>Next</STRONG>.
  <LI>On the <STRONG>Choose Shortcut Folder</STRONG> panel, indicate where you
  want icons created for the connector and click <STRONG>Next</STRONG>.
  <LI>Read the information on the <STRONG>Pre-installation Summary </STRONG>panel
  and click <STRONG>Install</STRONG>.
  <P>An informational panel indicates that the connector installation is in
  progress. When the installation process is finished, a panel indicates that
  installation is complete. </P>
	<LI>Click <STRONG>Done</STRONG>.
  <LI>
	<P>Apache Tomcat starts and deploys the connector manager and connector. </P>
	<LI>
	<P>If the checkbox &quot;Start SharePoint Connector Service after installation&quot;
	(mentioned in step 6) was unchecked, the connector service (which includes
	Apache Tomcat, connector manager and the connector) can be started as
	follows:</P>
	<UL>
			<LI>On <b>Windows</b>: Click on &quot;Programs &gt; GoogleConnectors &gt;
			[Connector name] &gt; <b>Start SharePoint Connector Service</b>&quot; to
			start it as a service or &quot;Programs &gt; GoogleConnectors &gt; [Connector
			name] &gt; <b>Start SharePoint Connector Console</b>&quot; to start it as a
			console.<LI>On <b>Linux</b>: Open a terminal window and go to the
			install location of the connector (e.g.
			/root/GoogleConnectors/SharePoint1) and use command &quot;<b>./Start_SharePoint_Connector_Console</b>&quot;
			to start it as a console. (the option to start as service is only
			available in Windows)</LI>
	</UL>
	<LI>Use the instructions in
	<A
  href="http://code.google.com/apis/searchappliance/documentation/50/connector_admin/sharepoint_connector.html#confconanch">Configuring
  the Connector</A> to register the connector manager and add the connector on
  the Admin Console of the Google Search Appliance. </LI></OL>
<H2><A id=installConnector name=installConnector></A>Installing the Connector
Manually </H2>
<P><b>Pre-Installation Instructions:</b></P>
<P class=note><B>Note :</B> Before installing the connector manually, ensure
that the following tasks have been performed</P>
<ol>
	<LI>Install <a href="http://java.sun.com/j2se/1.4.2/download.html">Java Development Kit (JDK) 1.4.2 (or later)</a> on the host.
  	<LI>Install <a href="http://tomcat.apache.org/download-55.cgi">Apache Tomcat 5.5</a> on the host.
	</LI>
	<LI>If you have installed JDK 1.4.2 on the host,
	<A
  href="http://tomcat.apache.org/download-55.cgi">download <CODE>JDK 1.4
  Compatibility Package </CODE></A>and unzip it in <CODE>$CATALINA_HOME.<SPAN
  class=style1> Follow the installation instructions provided by Apache.
  </SPAN></CODE></LI>
	<LI>Install a
	<a href="http://code.google.com/p/google-enterprise-connector-manager/">Connector
	Manager</a> on the Tomcat server.&nbsp; </LI>
	<LI>
	<a name="SupportingFiles"></a>Obtain following files from
	<a onclick="return top.js.OpenExtLink(window,event,this)" target="_blank" href="https://google-enterprise-connector-sharepoint.googlecode.com/svn/trunk/projects/sharepoint/lib">
	https://google-enterprise-connector-sharepoint.googlecode.com/svn/trunk/projects/sharepoint/lib</a>
	and and ensure that they are available during the installation process: </LI>
</ol>
<ul>
	<li>activation-1.1.jar</li>
	<li>axis.jar</li>
	<li>commons-codec-1.3.jar</li>
	<li>commons-discovery-0.2.jar</li>
	<li>HttpClient-Modified.jar</li>
	<li>jaxrpc.jar</li>
	<li>jcifs-1.2.15.jar</li>
	<li>joda-time-1.1.jar</li>
	<li>mail-1.4.jar</li>
	<li>saaj.jar</li>
	<li>wsdl4j-1.5.1.jar</li>
	<li>xercesImpl-2.8.1.jar</li>
	<li>xml-apis-1.3.03.jar</li>
</ul>
<ol>
	<li value="5">Download the <CODE>connector-sharepoint.jar </CODE>file and follow the
  instructions given bellow for installing. </li>
</ol>
<P><b>Installation Steps:</b></P>
<P class=note><B>Note :</B> To install the connector manually on external
servlet containers, follow the instructions given below</P>
<OL>
  <LI>On the Tomcat host, shut down Tomcat if running.
  <LI>Copy the connector-sharepoint.jar file to the <FONT
  face="Courier New">$CATALINA_HOME/webapps/connector-manager/WEB-INF/lib
  </FONT>directory.
  <LI>Copy all other .jar files listed in the &#8220;Pre-installation&#8221; section
	(<a href="#SupportingFiles">Step 5</a>) to the
  <FONT face="Courier New">$CATALINA_HOME/shared/lib </FONT>directory.
  <LI>Copy
  <FONT face="Courier New">$CATALINA_H</FONT><code>OME/server/lib/catalina.jar</code>&nbsp; to the
  <FONT face="Courier New">$CATALINA_HOME/shared/lib </FONT>directory.
  <LI>Restart the Tomcat server.
  <LI>To confirm whether the Tomcat server has restarted correctly and the
  connector is installed, navigate to the <FONT
  face="Courier New">$CATALINA_HOME/webapps/connector-manager/WEB-INF/connectors
  </FONT>directory, and verify that the <FONT
  face="Courier New">$CATALINA_HOME/webapps/connector-manager/WEB-INF/connectors/sharepoint-connector</FONT>
  directory exists. </LI></OL>
<H1><A id=confanch name=confanch></A>Configuring the Connector </H1>
<P>This section describes the configuration details for connector instances and
SharePoint Server.</P>
<P>You can define a connector instance for each SharePoint subsite (e.g.
<a href="http://www.mycompany.com:8000/abc">http://www.mycompany.com:8000/abc</a>
), or the main
top-level site (e.g. <a href="http://www.mycompany.com:8000">
http://www.mycompany.com:8000</a> ). A Microsoft SharePoint connector instance traverses the site
specified in its SharePoint URL, including any subsites that are located under
that site.</P>
<H2><A id=InstallAuto0 name=InstallAuto0></A>Registering Connector Manager on
Google Search Appliance</H2>
<P>To register connector manager with Google Search Appliance (GSA):</P>
<ol>
	<li>Go to Google Search Appliance admin console page.</li>
	<li>Go to Connector Administration &gt; Connector
	Managers </li>
	<li>Under &quot;Register a New Connector Manager&quot; provide manager name, description and location of the connector manager.</li>
	<li>Click on 'Save'.</li>
</ol>
<TABLE cellSpacing=0 cellPadding=0
summary="Required fields and information for configuring the Sharepoint connector"
border=0 id="table1">
  <TBODY>
  <TR>
    <TH scope=col width="113">Name</TH>
    <TH scope=col width="175">Description</TH>
    <TH scope=col>Values and Usage </TH></TR>
  <tr>
    <TD width="113">Manager name</TD>
    <TD width="175">The name of the Connector Manager</TD>
    <TD>
	e.g. CM001</TD>
	</tr>
  <TR>
    <TD width="113">Description</TD>
    <TD width="175">Description of the Connector Manager</TD>
    <TD>e.g. Primary Connector Manager for SharePoint 2007</TD></TR>
  <TR>
    <TD width="113">Location</TD>
    <TD width="175">The location of the Connector Manager.</TD>
    <TD>The URL of the application server where the connector-manager.war file 
	is installed. The URL must include the host name, port number, and the name 
	of the connector manager WAR file. Do not include the &quot;.war&quot; extension in 
	the file name; for example, if the file name is &quot;connector-manager.war&quot;, 
	type only &quot;connector-manager&quot;. An entry on the <strong>Location</strong> 
	text box might look like this:
	<a href="https://your.content.server.com:8080/connector-manager/">
	https://your.content.server.com:8080/connector-manager/</a>.</TD></TR>
  </TBODY></TABLE>
<H2><A id=confconanch name=confconanch></A>Configuring Connector Instances</H2>
<P>To configure an instance of a Microsoft SharePoint connector:</P>
<OL>
  <LI>Open the <B>Admin Console</B>.
  <LI>Click <STRONG>Crawl and index &gt; Feeds</STRONG>.
  <LI>In the <STRONG>List of Trusted IP Addresses</STRONG> section, select
  <STRONG>Trust feeds from all IP addresses</STRONG> or <STRONG>Only trust feeds
  from these IP addresses</STRONG>.
  <LI>If you selected <STRONG>Only trust feeds from these IP addresses</STRONG>
  in step 3, type in the trusted IP addresses.
  <LI>Click <STRONG>Save Settings</STRONG>.
  <LI>Click <B>Connector Administration</B> &gt; <B>Connectors</B>.
  <LI>Select the appropriate Connector Manager from the list.
  <LI>Click <B>Add New Connector</B> to create a new SharePoint Connector
  instance.
  <LI>Specify Connector Name and click <B>Get Configuration Form</B>. </LI></OL>
<P>The following table describes the fields that you must complete to configure
a Microsoft SharePoint connector: </P>
<TABLE cellSpacing=0 cellPadding=0
summary="Required fields and information for configuring the Sharepoint connector"
border=0 id="table1">
  <TBODY>
  <TR>
    <TH scope=col>Name</TH>
    <TH scope=col>Description</TH>
    <TH scope=col>Values and Usage </TH></TR>
  <tr>
    <TD>SharePoint Version</TD>
    <TD>The SharePoint server type that you want to traverse. </TD>
    <TD>
	<ul>
		<li>SharePoint 2003:&nbsp; Microsoft SharePoint Server 2007 (covers
		MOSS2007 or WSS 3.0)</li>
		<li>SharePoint 2007:&nbsp; Microsoft SharePoint Server 2003 (covers
		SPS2003 or WSS 2.0)</li>
	</ul>
	</TD>
	</tr>
  <TR>
    <TD>Crawl URL </TD>
    <TD>The URL for the SharePoint site that you want to traverse. </TD>
    <TD>The Google Search Appliance traverses this site and any subsites found
      under it. This is the Crawl URL you designate on the Connector
      Configuration page, not the Google Search Appliance Crawl Configuration
      page.
      <P>The URL must contain a fully qualified domain name,&nbsp; For
      example, this URL is
      correct:<BR><BR>http://server.domain.com/mysite<BR><BR>We recommend that
      you do not have two connector instances accessing the same SharePoint
      Crawl URL. </P></TD></TR>
  <TR>
    <TD>SharePoint Site Alias Host Name </TD>
    <TD>If you have SharePoint hosted on an intranet host, alias host name and
      the gateway host name are the same. </TD>
    <TD>Optional field. The Google Search Appliance uses this for resolving
      the SharePoint URLs for SharePoint hosted inside an intranet.
  <BR><BR></TD></TR>
  <TR>
    <TD>SharePoint Site Alias Port Number </TD>
    <TD>If the SharePoint is hosted on an intranet host, the alias port number
      is the port number Server on the gateway for the internal SharePoint
      Server.</TD>
    <TD>Optional field. The Google Search Appliance uses the port number for
      resolving the SharePoint URLs from SharePoint hosted on the intranet. The
      value must be numeric. <BR><BR></TD></TR>
  <TR>
    <TD>Windows Domain </TD>
    <TD>A valid domain name. </TD>
    <TD>The Windows domain where the user is authenticated. If you are using a
      local (machine) user, provide the machine name.</TD></TR>
  <TR>
    <TD>Username and password </TD>
    <TD>A valid username and password on the SharePoint Server's domain. </TD>
    <TD>The user must have access to the Web services on the SharePoint site.
      The connector instance uses these credentials to traverse the site and
      construct a list of URLs and metadata. For more information on user
      permissions, see <A
      href="http://code.google.com/apis/searchappliance/documentation/50/connector_admin/sharepoint_connector.html#confecmanch">Configuring
      Microsoft SharePoint Server for the Connector</A>.</TD></TR>
  <TR>
    <TD>MySite URL
	<p>(Applicable for MOSS2007)</TD>
    <TD>URL for the SharePoint MySite that you want to traverse with this
      connector instance. </TD>
    <TD>The Google Enterprise Connector for Microsoft SharePoint uses the
      MySite base URL and the credentials you provide to determine the complete
      MySite URL, then crawls MySite and feeds metadata and URLs to the Google
      Search Appliance for indexing. <BR><BR>For example, if the MySite URL is:
      <FONT
      face="Courier New">http://server.domain/<EM>personal/administrator</EM>/default.aspx</FONT>,
      you need to specify only <FONT
      face="Courier New">http://server.domain</FONT>. This is an optional field
	and is only available when &quot;SharePoint 2007&quot; is selected in &quot;SharePoint
	Version&quot;.
    </TD></TR>
  <TR>
    <TD>Include URLs Matching the Following Patterns</TD>
    <TD>URL patterns you want to traverse with this connector instance. </TD>
    <TD>The Google Search Appliance traverses SharePoint URLs matching the
      specified URL patterns. These are in addition to the file system and web
      URLs you specify on the Crawl Configuration page.
      <P>The URL patterns must be provided in a separate line. You
      must include the SharePoint Site URL in the specified URL patterns. You
      must also include the MySite URL if you specified MySite.</P>
	<P>e.g. Specify <a href="http://www.mycompany.com/">
	http://www.mycompany.com/</a> to crawl the site http://www.mycompany.com and
	all its subsites or Specify .* to crawl all the URL patterns. </P></TD></TR>
  <TR>
    <TD>Do Not Include URLs Matching the Following Patterns </TD>
    <TD>URL patterns you do not want to traverse with this connector instance.
    </TD>
    <TD>The Google Search Appliance traverses only the SharePoint URLs that do
      not match the specified URL patterns. These are in addition to the Do Not
      Include URLs you specify on the Crawl Configuration page. <BR><BR>The URL
	patterns must be provided in a separate line. This is an optional
      field.<p>e.g. Specify <a href="http://www.mycompany.com/subsite">
	http://www.mycompany.com/subsite</a> so that the specific subsite is not
	included in the crawl</TD></TR></TBODY></TABLE>
<H2><A id=ScheduleConnector name=ScheduleConnector></A>Scheduling the
Connector</H2>
<P>Note that a connector scheduled to run from 12 a.m. to 12 a.m. always runs.
Any other schedule with the same beginning and ending time never runs, either
for a connector or for the Google Search Appliance's standard crawl function.
</P>
<H2><A id=confecmanch name=confecmanch></A>Configuring Microsoft SharePoint
Server for the Connector</H2>
<P>To prevent the Google Search Appliance from traversing a particular a
SharePoint site or URLs and files on that site, create a Robots.txt file listing
those sites, URLs, and files, then place the Robots.txt file in the home
directory of the default web site on the server. Ensure that the Robots.txt file
is a public file. </P>
<h3>Configurations for SharePoint site to have FQDN (Fully Qualified Domain
Name)</h3>
<p>GSA (Google Search Appliance) works only if the URL has fully qualified host
name. MOSS 2007 by default makes user access the sites using short name. If
that's how your sites are configured, the URL with short host name sent to the
appliance will not be processed.</p>
<p>Steps to configure SharePoint site to have FQDN:</p>
<ol>
	<li>Open the Central Administration from start menu</li>
	<li>Go to Central Administration &gt; Operations &gt; Alternate Access Mappings</li>
	<li>You will see several Internal URL for SharePoint site and admin site.
	The default settings are shortened URLs. What this means is that if you type
	in fully qualified host name in browser such as:<p>
	<a href="http://moss_host1.yourdomain.com/">
	http://moss_host1.yourdomain.com/</a>&nbsp; , it will redirect to</p>
	<p><a href="http://moss_host1/Pages/Default.aspx">
	http://moss_host1/Default.aspx</a>.</li>
	<li>Click on the shortened URL.</li>
	<li>Edit the URL to make it FQDN compliant. For e.g. change URL from
	<a href="http://moss_host1/Pages/Default.aspx">http://moss_host1/</a> to
	<a href="http://moss_host1/Pages/Default.aspx">
	http://moss_host1.yourdomain.com/</a> .</li>
	<li>Click Ok.</li>
</ol>
<H3>Required User Credentials </H3>
<P>Each instance of this connector requires the following two sets of user
credentials:</P>
<UL>
  <LI>The connector instance
  <LI>Crawler access on the Google Search Appliance. </LI></UL>
<P>Depending on your security policy, you may choose to create a single user
account that has permissions for both functions.</P>
<UL>
  <LI>The user account for the connector instance (<STRONG>Connector
  Administration &gt; Add Connector</STRONG>) must have the following
  permissions on the SharePoint Site:
  <UL>
    <LI>If you use server farms to host this content, the user must be a server
    farm administrator.
    <LI>The user must have read access for the content database.
    <LI>The user must be a site collection administrator.
    <LI>The user must have permission to access the Windows SharePoint
    site.<BR></LI></UL>
  <LI>The user account for the Google Search Appliance (<STRONG>Crawl and Index
  &gt; Crawler Access</STRONG>) must have read access for all content on the
  SharePoint site. </LI></UL>
<H1><A id=troubanch name=troubanch></A>Troubleshooting</H1>
<P>This section provides information on troubleshooting the Google Enterprise
Connector for Microsoft SharePoint Server 2003 and Microsoft SharePoint Server
2007. This section includes the
following topics: </P>
<UL>
  <LI>Known Limitations</LI>
	<LI>Error Messages </LI></UL>
<h2><a id="issueanch" name="issueanch"></a>Known Limitations </h2>
<p></p>
<p><b>SharePoint connector configuration-parameters cannot have special
	characters: </b></p>
<p>If your SharePoint connector configuration-parameter contains
characters such as &quot;&lt;&quot;, &quot;&gt;&quot; . E.g. password containing &quot;&lt;&quot;(pass&lt;!@#),
connector-manager fails to save the SharePoint configuration.&nbsp;
</p>
<p>
<a href="http://code.google.com/p/google-enterprise-connector-sharepoint/issues/detail?id=3&can=1">http://code.google.com/p/google-enterprise-connector-sharepoint/issues/detail?id=3&amp;can=1</a></p>
<p><b>GSA removes port number from the submitted URLs having port 80: </b></p>
<p>Google Search Appliance (GSA)&nbsp;
removes the port number from the URLs fed by connector if it contain port 80.
</p>
<p>For e.g. <a href="http://www.mycompany.com:80/abc">http://www.mycompany.com:80/abc</a> will get changed to
<a href="http://www.mycompany.com:80/abc">http://www.mycompany.com/abc</a>. Due
to this behavior of the appliance, even though you specify&nbsp;
<a href="http://www.mycompany.com:80/abc">http://www.mycompany.com:80/abc</a>
under &quot;Follow and Crawl Only URLs with the Following Patterns&quot; section of
appliance and connector feeding&nbsp; the same URL (<a href="http://www.mycompany.com:80/abc">http://www.mycompany.com:80/abc</a>),&nbsp;
it still causes a pattern mismatch.</p>
<p>
<a href="http://code.google.com/p/google-enterprise-connector-sharepoint/issues/detail?can=1&id=9">http://code.google.com/p/google-enterprise-connector-sharepoint/issues/detail?can=1&amp;id=9</a></p>
<H2><A id=erranch name=erranch></A>Error Messages </H2>
<P>This section describes some commonly encountered error messages and their
likely solutions.</P>
<P><B>Crawl URL does not match 'Include URL' patterns or matches 'Do Not Include
URL' patterns. </B></P>
<P>If user provided Crawl URL which does not match patterns specified under &quot;Include URLs Matching the Following Patterns&quot;
or matches patterns specified under &quot;Do Not Include URLs Matching the Following Patterns&quot;.&nbsp;
User should provide non-conflicting patterns for &quot;Include URLs Matching the Following Patterns&quot;
and &quot;Do Not Include URLs Matching the Following Patterns&quot;.</P>
<H3><B>Required field not specified. </B></H3>
<P>Fields marked with an asterisk (*) on the Configuring Connector Instances
form are required. You must provide appropriate values for these fields. </P>
<H3><B>The Crawl URL must contain a fully qualified domain name. Please check
the Crawl URL value. </B></H3>
<P>You must provide the appropriate SharePoint Site URL with a fully qualified
domain name for SharePoint Site URL field on Configuring Connector Instances.
</P>
<H3><B>Cannot connect to the given SharePoint Site URL with the supplied
Domain/Username/Password. Please re-enter. </B></H3>
<P>You must provide appropriate values for all the mandatory fields on
configuring connector instances.
<P class=note><B>Note :</B> All other error messages are available in the Tomcat
log file.</P>
<H1><A name=relatedanch></A>Related Documentation</H1>
<UL>
  <LI><A
  href="http://code.google.com/apis/searchappliance/documentation/50/connector_admin/admin_connector.html">Google
  Search Appliance Connector Manager Admin Guide</A>
  <LI><A
  href="http://code.google.com/apis/searchappliance/documentation/50/secure_search/secure_search_overview.html">Managing
  Search for Controlled Access Content</A>
  <LI><A
  href="http://code.google.com/apis/searchappliance/documentation/50/metadata.html">Google
  Search Appliance External Metadata Indexing Guide</A>
  <LI><A
  href="http://code.google.com/apis/searchappliance/documentation/50/xml_reference.html#request_meta">Google
  Search Appliance Search Protocol Reference</A>
  <LI>
	<a href="http://java.sun.com/javase/6/docs/api/java/util/regex/Pattern.html">
	SharePoint Connector URL Patterns Reference for Inclusion\Exclusion</a><LI>Bill English, The Microsoft SharePoint Community Experts (2007).<EM>
  Microsoft Office SharePoint Server 2007 Administrator's Companion.
  </EM>Microsoft Press. ISBN 0-7356-2282-5. </LI></UL>
<P class=backtotop><A
href="http://code.google.com/apis/searchappliance/documentation/50/connector_admin/sharepoint_connector.html#top">Back
to top</A></P></DIV><!-- ########## END PAGE CONTENT ########## --></DIV><!-- end wrapper --><!-- ########## PAGE FOOTER ########## -->
<DIV id=footer>
<DIV id=footerlogo><IMG alt="Google color balls"
src="art.gif"></DIV>
<DIV id=copyright>
©2007 Google - <A href="http://www.google.com/privacy.html">Privacy
Policy</A> - <A href="http://www.google.com/terms_of_service.html">Terms and
Conditions</A> - <A href="http://www.google.com/about.html">About
Google</A></DIV><!-- end copyright --></DIV><!-- ########## END PAGE FOOTER ########## -->
<SCRIPT
src="file:///C:/Documents%20and%20Settings/amit_kagrawal/Desktop/amit_gsp/Google%20Enterprise%20Connector%20for%20Microsoft%20SharePoint%20Server%202007_files/urchin.js"
type=text/javascript>
</SCRIPT>

<SCRIPT
type=text/javascript>
  _uacct="UA-18071-1";
  urchinTracker();
</SCRIPT>

<P></P>
</body>
</html>
